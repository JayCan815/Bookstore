
<!DOCTYPE html>

<html>
	<head>
	<script src="https://code.jquery.com/jquery-3.6.0.js"
	integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous">
	</script>

	<style>
		
		.centered{
			width: 800px;
			margin: 0 auto;
			text-align: center;
		
		}
		.form{
			border: none;
			border-bottom:2px solid rod;
		}
	</style>

	</head>

	<body>
		<script>
		var token;

		function LoginAuth(){
		$.post("/loginauth", {"username":$("#username").val(),"password":$("#password").val()},
			function(data) {
				if(data.data.jwt){
					token = data.data;
				}
				else {
					alert(data.data.message);
				}
				if(token != undefined){
					$("#login").hide();
					$("#storepage").show();
					displayBooks();
				}

			});
		}

		function SignupAuth(){
		

			$.post("/signup",{"username":$("#newuser").val(),"password":$("#newpw").val()},
				function(data){
					alert(data.data.message);
			});
			$("#login").show();
			$("#signup").hide();
		}

		function showSignup(){
			$("#login").hide();
			$("#signup").show();
		}







		
		function displayBooks(){
			$.get("/storepage",{"jwt": token.jwt}, 
				function(data){
					for(i = 0; i < data.books.length; i++){
					document.getElementById("storepage").innerHTML +=
							'<h1> Title: ' +  data.books[i][0] +
							' Price: ' +  data.books[i][1] + '.99  ' + 
							 '<button id="' + data.books[i][0] + '"onclick="BuyBook(this.id);"> Buy! </button></h1>';
					}
				});
		}
		
		function BuyBook(title){
			$.get("/buy",{"book_title": title}, function(data){
				alert(data.data.message);
			});
		}

		</script>
		<div class ="centered"><h1>My Bookstore! </h1></div>

		<div id ="login" class ="centered">

			<label for ="username"> User </label> <input class ="form" type ="text" id = "username" name = "username" required> <br>
			<label for ="password"> Password </label> <input class="form" type = "password" id = "password" name = "password"> <br>
			<input  id ="login_submit" type ="submit" value = "Log in" onclick="return LoginAuth();">
			<input id ="sign_submit"  type ="submit" value = "Sign Up" onclick="return showSignup();">


		</div>

		<div class="centered" id = "signup" style="display: none">
			<div text-align="center" ><h1> Sign up. </h1></div>
			  <label for ="newuser"> User </label> <input type ="text" id = "newuser" name = "newuser" required> <br>
			  <label for ="newpw"> Password </label> <input type = "password" id = "newpw" name = "newpw"> <br>	
			  <input id ="signup_complete" type ="submit" value = "Done" onclick="return SignupAuth();">
		</div>


		<div id="storepage" style="display: none"> </div>
	</body>



